# Configé…ç½®è¯´æ˜

> ## ğŸš¨ å¼ƒç”¨è¯´æ˜
>
> æœ¬æ–‡æ¡£å·²è¿‡æ—¶ï¼Œä¸å†è¿›è¡Œç»´æŠ¤ï¼Œå¹¶å°†åœ¨ *1.6.0* ç‰ˆæœ¬ä¸‹æ¶ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«è¿‡æ—¶çš„ä¿¡æ¯æˆ–å·²è¢«æ›´æ–°çš„åŠŸèƒ½æ›¿ä»£ã€‚å»ºè®®å‚è€ƒæœ€æ–°çš„ **[å®˜æ–¹æ–‡æ¡£-é…ç½®æ–‡ä»¶è¯´æ˜](https://www.mindspore.cn/mindformers/docs/zh-CN/r1.5.0/appendix/conf_files.html)** ï¼Œä»¥è·å–å‡†ç¡®çš„ä¿¡æ¯ã€‚
>
> å¦‚æœæ‚¨ä»éœ€ä½¿ç”¨æœ¬æ–‡æ¡£ä¸­çš„å†…å®¹ï¼Œè¯·ä»”ç»†æ ¸å¯¹å…¶é€‚ç”¨æ€§ï¼Œå¹¶ç»“åˆæœ€æ–°ç‰ˆæœ¬çš„ç›¸å…³èµ„æºè¿›è¡ŒéªŒè¯ã€‚
>
> å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ **[ç¤¾åŒºIssue](https://gitee.com/mindspore/mindformers/issues/new)** æäº¤åé¦ˆã€‚æ„Ÿè°¢æ‚¨çš„ç†è§£ä¸æ”¯æŒï¼

## é…ç½®é¡¹é¡ºåº

configsç»Ÿä¸€åœ¨run_xxx.yamlä¸­ï¼Œæ’åºæŒ‰ç…§ä¿®æ”¹é¢‘ç‡çš„é¡ºåºå’Œä¸€èˆ¬çš„æ¨¡å‹è®­ç»ƒæµç¨‹é¡ºåºï¼ˆæ•°æ®é›†->æ¨¡å‹->è®­ç»ƒã€è¯„ä¼°ã€æ¨ç†ï¼‰ï¼Œå…·ä½“é¡ºåºå¦‚ä¸‹

- éæ¨¡å—å‚æ•°ï¼šseedã€run_modeã€output_dirã€load_checkpointã€resume_trainingã€auto_trans_ckptã€use_graceful_exit
- ç¯å¢ƒå‚æ•°ï¼šcontext
- AICCï¼šremote_save_url
- è¿è¡Œå‚æ•°ï¼šrunner_configã€runner_wrapper
- å¹¶è¡Œè®¾ç½®ï¼šuse_parallelã€parallelã€parallel_config
- MOEï¼šmoe_config
- é‡è®¡ç®—ï¼šrecompute_config
- ç®—å­è°ƒä¼˜ï¼šauto_tune
- æ€§èƒ½å·¥å…·ï¼šprofile
- Trainerï¼štrainer
- æ•°æ®é›†ï¼štrain_datasetã€train_dataset_taskã€eval_datasetã€eval_dataset_task
- æ¨¡å‹ï¼šmodel
- å­¦ä¹ ç‡ï¼šlr_scheduleã€layer_scaleã€layer_decayã€lr_scaleã€lr_scale_factor
- ä¼˜åŒ–å™¨ï¼šoptimizer
- å›è°ƒå‡½æ•°ï¼šcallbacks
- è¯„ä¼°å‡½æ•°ï¼šmetric
- Processorï¼šprocessor

## è¯¦ç»†é…ç½®è¯´æ˜

- seed: éšæœºç§å­ï¼Œå¯ä»¥å‚è€ƒ[mindspore.set_seed](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/mindspore/mindspore.set_seed.html)
- run_mode: è¿è¡Œæ¨¡å¼ï¼Œå¯é€‰"train"ã€"finetune"ã€"eval"æˆ–"predict"
- output_dir: './output'  ä¿å­˜checkpointã€strategyçš„è·¯å¾„
- load_checkpoint: åŠ è½½æƒé‡çš„æ¨¡å‹åæˆ–æƒé‡è·¯å¾„ï¼Œè‹¥è¿›è¡Œå…¨å‚å¾®è°ƒ/æ¨ç†ï¼Œæ”¯æŒä¼ å…¥å®Œæ•´æƒé‡è·¯å¾„æˆ–ç¦»çº¿åˆ‡åˆ†å®Œæˆçš„æƒé‡æ–‡ä»¶å¤¹ï¼›å¯¹äºLoraå¾®è°ƒ/æ¨ç†ï¼Œåœ¨æ”¯æŒä¸Šè¿°ä¼ å…¥æ–¹å¼ä»¥å¤–ï¼Œè¿˜æ”¯æŒåŒæ—¶ä¼ å…¥Baseã€Loraæƒé‡ï¼Œä¼ å…¥æ ¼å¼ä¸º`load_checkpoint=path/to/dir/`ï¼Œå…¶ä¸­dirè·¯å¾„ä¸‹åŒ…å«`{BASE_MODEL}.ckpt`ã€`{LORA_MODEL}.ckpt`ã€‚
- auto_trans_ckpt: æ˜¯å¦å¼€å¯è‡ªåŠ¨åœ¨çº¿æƒé‡åˆ‡åˆ†æˆ–è½¬æ¢
- resume_training: åŠ è½½æ–¹å¼ï¼Œä¸ºTrueæ—¶ä¼šåŠ è½½è®­ç»ƒè¿‡ç¨‹ä¿¡æ¯ï¼Œå¦‚ä¼˜åŒ–å™¨ã€epochsæ•°ç­‰
- use_graceful_exitï¼šæ˜¯å¦å¼€å¯ä¼˜é›…é€€å‡ºåŠŸèƒ½ï¼Œå¼€å¯æ—¶éœ€è¦é…ç½®ç›¸åº”çš„callbackå‡½æ•°
- context: ç¯å¢ƒé…ç½®ï¼Œå¯ä»¥å‚è€ƒ: [mindspore.set_context](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/mindspore/mindspore.set_context.html)
    - mode: 0ä»£è¡¨Graph Modeï¼Œ 1ä»£è¡¨Pynative Mode
    - device_target: è®¾å¤‡ç±»å‹ï¼ŒAscendã€CPUæˆ–GPUï¼Œé»˜è®¤ä¸ºAscend
    - max_call_depth: å‡½æ•°è°ƒç”¨çš„æœ€å¤§æ·±åº¦
    - max_device_memory: è®¾ç½®è®¾å¤‡å¯ç”¨çš„æœ€å¤§å†…å­˜ã€‚è¿è¡Œå¤šæœºä»»åŠ¡æ—¶éœ€è¦é€‚å½“å‡å°ï¼Œä¸ºè®¾å¤‡é—´é€šä¿¡ç•™å‡ºæ›´å¤šå†…å­˜ç©ºé—´ã€‚
    - save_graphs: æ˜¯å¦ä¿å­˜å›¾
    - device_id: é»˜è®¤è®¾å¤‡id
- remote_save_url: ä½¿ç”¨AICCè®­ç»ƒä½œä¸šæ—¶çš„ï¼Œç›®æ ‡æ¡¶çš„å›ä¼ æ–‡ä»¶å¤¹è·¯å¾„
- runner_config: è¿è¡Œé…ç½®
    - epochs: è¿­ä»£æ¬¡æ•°
    - batch_size: æ•°æ®æ‰¹æ¬¡å¤§å°ï¼Œå½“å‰åœ¨ä½¿ç”¨yamlåˆå§‹åŒ–è®­ç»ƒæ—¶ï¼Œä¼šè¦†ç›–æ•°æ®é›†é…ç½®ä¸­çš„batch_sizeï¼Œåé¢ä¼šåˆ é™¤æ”¹é…ç½®
    - sink_mode: æ˜¯å¦å¼€å¯æ•°æ®ä¸‹æ²‰æ¨¡å¼
    - sink_size: æ¯æ¬¡ä¸‹æ²‰æ•°æ®å¤§å°ï¼Œ-1ä»£è¡¨å…¨é‡ä¸‹æ²‰
    - gradient_accumulation_steps: æ¢¯åº¦ç´¯ç§¯æ­¥æ•°ï¼Œè¡¨ç¤ºè®­ç»ƒç»è¿‡å¤šå°‘stepåå¯¹æ¨¡å‹æƒé‡è¿›è¡Œä¸€æ¬¡ä¼˜åŒ–æ›´æ–°ï¼›æœªè®¾ç½®æ—¶é»˜è®¤å€¼ä¸º1ï¼Œä¸å¼€å¯æ¢¯åº¦ç´¯ç§¯ï¼›å¯å‚è€ƒ[ç‰¹æ€§æ–‡æ¡£](../docs/feature_cards/Training_Algorithms.md)
- runner_wrapper: wrapperé…ç½®
    - type: wrapperç±»
    - scale_sense: æ¢¯åº¦ç¼©æ”¾é…ç½®
        - type: æ¢¯åº¦ç¼©æ”¾ç±»
        - use_clip_grad: æ˜¯å¦å¼€å¯æ¢¯åº¦è£å‰ª
        - loss_scale_value: ç¼©æ”¾ç³»æ•°
- use_parallel: æ˜¯å¦å¼€å¯å¹¶è¡Œ
- parallel: è‡ªåŠ¨å¹¶è¡Œé…ç½®ï¼Œå¯ä»¥å‚è€ƒï¼š[mindspore.set_auto_parallel_context](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/mindspore/mindspore.set_auto_parallel_context.html)
    - parallel_mode: å¹¶è¡Œæ¨¡å¼ï¼Œ0-datasetæ•°æ®å¹¶è¡Œ, 1-semiåŠè‡ªåŠ¨å¹¶è¡Œ, 2-autoè‡ªåŠ¨å¹¶è¡Œ, 3-hybridæ‰‹å·¥å®ç°å¹¶è¡Œã€‚autoè‡ªåŠ¨å¹¶è¡Œç›¸å…³è¯´æ˜å‚è€ƒ[è‡ªåŠ¨å¹¶è¡Œ](../docs/feature_cards/Auto_Parallel.md)
    - gradients_mean: æ˜¯å¦åœ¨æ¢¯åº¦AllReduceåæ‰§è¡Œå¹³å‡ç®—å­ã€‚é€šå¸¸åŠè‡ªåŠ¨å¹¶è¡Œæ¨¡å¼ä¸‹ä¸ºFalseï¼Œæ•°æ®å¹¶è¡Œæ¨¡å¼ä¸‹ä¸ºTrue
    - enable_alltoall: å…è®¸åœ¨é€šä¿¡æœŸé—´ç”ŸæˆAllToAllé€šä¿¡ç®—å­çš„å¼€å…³ã€‚é€šå¸¸ä»…åœ¨MOEåœºæ™¯ä¸‹æ‰“å¼€ï¼Œé»˜è®¤False
    - full_batch: åœ¨auto_parallelæ¨¡å¼ä¸‹åŠ è½½æ•´ä¸ªbatchæ•°æ®é›†æ—¶ä¸ºTrueã€‚åŠè‡ªåŠ¨å¹¶è¡Œæ¨¡å¼é€šå¸¸è®¾ç½®ä¸ºTrueï¼Œæ•°æ®å¹¶è¡Œæ¨¡å¼å¿…é¡»è®¾ç½®ä¸ºFalseï¼Œå¦åˆ™ä¼šæŠ¥é”™
    - search_mode: ç­–ç•¥æœç´¢æ¨¡å¼ï¼Œæœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯recursive_programmingï¼Œdynamic_programmingå’Œsharding_propagationã€‚ä»…åœ¨å…¨è‡ªåŠ¨å¹¶è¡Œæ¨¡å¼ä¸‹ç”Ÿæ•ˆï¼Œå…¶ä»–æ¨¡å¼ä¸ç”Ÿæ•ˆï¼Œå®éªŒæ€§æ¥å£ï¼Œè°¨æ…ä½¿ç”¨
    - enable_parallel_optimizer: æ•°æ®å¹¶è¡Œè®­ç»ƒæ—¶å¯¹æƒé‡æ›´æ–°è®¡ç®—è¿›è¡Œåˆ†ç‰‡ã€‚ä¼˜åŒ–å™¨å¹¶è¡Œå¼€å…³ï¼Œåœ¨æ•°æ®å¹¶è¡Œè®­ç»ƒæ—¶é»˜è®¤ä¼šå°†æ¨¡å‹æƒé‡å‚æ•°åˆ‡åˆ†æˆdevice_numä»½ï¼›åŠè‡ªåŠ¨å¹¶è¡Œæ—¶é»˜è®¤å°†æ¨¡å‹æƒé‡å‚æ•°åˆ‡ä»½data_parallelä»½
    - strategy_ckpt_save_file: ä¿å­˜å¹¶è¡Œåˆ‡åˆ†ç­–ç•¥çš„è·¯å¾„ã€‚
    - strategy_ckpt_config: ç­–ç•¥æ–‡ä»¶ç›¸å…³é…ç½®é¡¹
        - only_trainable_params: ä»…ä¿å­˜/åŠ è½½å¯è®­ç»ƒå‚æ•°çš„ç­–ç•¥ä¿¡æ¯ï¼Œé»˜è®¤ä¸ºTrueï¼Œå½“ç½‘ç»œä¸­å­˜åœ¨å†»ç»“çš„å‚æ•°ä½†åˆéœ€è¦åˆ‡åˆ†æ—¶ï¼ˆä¾‹å¦‚å¾®è°ƒåœºæ™¯ä¸‹ï¼‰å°†å…¶è®¾ä¸ºFalse
    - parallel_optimizer_config: ç”¨äºå¼€å¯ä¼˜åŒ–å™¨å¹¶è¡Œåçš„è¡Œä¸ºé…ç½®ã€‚ä»…åœ¨enable_parallel_optimizer=Trueçš„æ—¶å€™ç”Ÿæ•ˆã€‚
        - gradient_accumulation_shard: è®¾ç½®ç´¯åŠ æ¢¯åº¦å˜é‡æ˜¯å¦åœ¨æ•°æ®å¹¶è¡Œç»´åº¦ä¸Šè¿›è¡Œåˆ‡åˆ†ã€‚
        - parallel_optimizer_threshold: è®¾ç½®å‚æ•°åˆ‡åˆ†çš„é˜ˆå€¼ã€‚
        - optimizer_weight_shard_size: è®¾ç½®æŒ‡å®šä¼˜åŒ–å™¨æƒé‡åˆ‡åˆ†é€šä¿¡åŸŸçš„å¤§å°ã€‚å¤šæœºè®­ç»ƒdpæ•°è¾ƒå¤§æ—¶å¯ä»¥é€‚å½“è®¾ç½®ä¸ºä¸€ä¸ªè¾ƒå°çš„å€¼ï¼ˆéœ€è¦èƒ½æ•´é™¤dpå€¼ï¼‰ã€‚
- parallel_config: å¹¶è¡Œç­–ç•¥é…ç½®ï¼Œå¯ä»¥å‚è€ƒ`mindformers.modules.transformer.TransformerOpParallelConfig`ï¼Œå¹¶è¡Œé…ç½®æ¶‰åŠ**ç®—å­çº§å¹¶è¡Œ**ï¼Œå¯å‚è€ƒ[æ–‡æ¡£](https://www.mindspore.cn/tutorials/experts/zh-CN/r2.3.0rc2/parallel/operator_parallel.html)ã€‚
    - data_parallel: æ•°æ®å¹¶è¡Œï¼Œè‡ªåŠ¨å¹¶è¡ŒåŒé€’å½’ç­–ç•¥æœç´¢ç®—æ³•ä¸‹æ— éœ€é…ç½®
    - model_parallel: æ¨¡å‹å¹¶è¡Œï¼Œè‡ªåŠ¨å¹¶è¡ŒåŒé€’å½’ç­–ç•¥æœç´¢ç®—æ³•ä¸‹æ— éœ€é…ç½®
    - context_parallel: åºåˆ—å¹¶è¡Œï¼Œåœ¨åºåˆ—ç»´åº¦è¿›è¡Œåˆ‡åˆ†ï¼Œæ¯å°è®¾å¤‡åªè´Ÿè´£1/context_parallelçš„Qå’ŒKVè¿›è¡Œè‡ªæ³¨æ„åŠ›å€¼è®¡ç®—ï¼Œä¸å†éœ€è¦å•ä¸ªè®¾å¤‡æ¥ä¿å­˜æ•´ä¸ªåºåˆ—ï¼Œä½¿æ³¨æ„åŠ›çŸ©é˜µä¸åºåˆ—é•¿åº¦ç”±å¹³æ–¹å…³ç³»å˜æˆçº¿æ€§å…³ç³»ï¼Œæœ‰æ•ˆé™ä½æ¯å°è®¡ç®—è®¾å¤‡æ˜¾å­˜å‹åŠ›ï¼Œcontext_parallelä»£è¡¨åºåˆ—å¹¶è¡Œæ•°ï¼Œæ­¤å¤„ä¸º1è¡¨ç¤ºä¸å¼€å¯ï¼Œæ­¤å¤„ä¸º2è¡¨ç¤º2å¡å¹¶è¡Œã€‚
    - mem_coeff: è‡ªåŠ¨å¹¶è¡ŒåŒé€’å½’ç­–ç•¥æœç´¢ç®—æ³•ä¸‹éœ€é…ç½®ï¼Œæ§åˆ¶ç­–ç•¥ç”Ÿæˆæ›´å€¾å‘äºæ•°æ®å¹¶è¡Œæˆ–è€…æ¨¡å‹å¹¶è¡Œï¼Œæ•°å€¼è¶Šå¤§ï¼Œæ¨¡å‹å¹¶è¡Œæ•°è¶Šå¤§ã€‚é…ç½®å€¼èŒƒå›´ä¸º[0.125, 1024], é…ç½®å€¼ä¸º0.125æ—¶ï¼Œç”Ÿæˆçº¯æ•°æ®å¹¶è¡Œç­–ç•¥ï¼›é…ç½®å€¼ä¸º2014æ—¶ï¼Œç”Ÿæˆçº¯æ¨¡å‹å¹¶è¡Œç­–ç•¥ï¼›
    - pipeline_stage: æµæ°´çº¿å¹¶è¡Œ
  > éœ€è¦æ»¡è¶³å®é™…è¿è¡Œçš„å¡æ•° device_num = data_parallel Ã— model_parallel Ã— context_parallel Ã— pipeline_stageã€‚è‡ªåŠ¨å¹¶è¡Œä¸‹æ— æ­¤çº¦æŸï¼Œä½†è¦ä¿è¯stageå†…çš„å¡æ•°`stage_device_num`æ˜¯2çš„å¹‚
    - use_seq_parallel: æ˜¯å¦å¼€å¯åºåˆ—å¹¶è¡Œï¼Œå¼€å¯åå°†Transformerå±‚ä¸­çš„LayerNormä»¥åŠDropoutçš„è¾“å…¥æŒ‰åºåˆ—ç»´åº¦è¿›è¡Œåˆ‡åˆ†ï¼Œä½¿å„è®¾å¤‡åªéœ€å¤„ç†éƒ¨åˆ†çš„LayerNormå’ŒDropoutï¼Œå‡å°‘æ¨¡å‹æ˜¾å­˜å ç”¨ã€‚æ³¨æ„å½“context_parallelå¼€å¯åï¼Œè¯¥å‚æ•°ä¸ç”Ÿæ•ˆã€‚
    - micro_batch_num: æµæ°´çº¿å¹¶è¡Œçš„å¾®æ‰¹æ¬¡å¤§å°ã€‚pipeline_satgeå¤§äº1æ—¶ï¼Œå¼€å¯æµæ°´å¹¶è¡Œæ—¶ä½¿ç”¨ï¼Œæ­¤å¤„éœ€æ»¡è¶³micro_batch_num >= pipeline_satge
    - gradient_aggregation_group: æ¢¯åº¦é€šä¿¡ç®—å­èåˆç»„çš„å¤§å°
- micro_batch_interleave_num: batch_sizeçš„æ‹†åˆ†ä»½æ•°ï¼Œå¤šå‰¯æœ¬å¹¶è¡Œå¼€å…³ï¼Œé€šå¸¸åœ¨æ¨¡å‹å¹¶è¡Œæ—¶ä½¿ç”¨ï¼Œç”¨äºä¼˜åŒ–model_parallelæ—¶äº§ç”Ÿçš„é€šä¿¡æŸè€—ï¼Œçº¯æµæ°´å¹¶è¡Œæ—¶ä¸å»ºè®®ä½¿ç”¨ã€‚å¯ä»¥å‚è€ƒ[mindspore.nn.MicroBatchInterleaved](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/nn/mindspore.nn.MicroBatchInterleaved.html)
- moe_config: æ··åˆä¸“å®¶é…ç½®ï¼Œå½“å‰å¤§éƒ¨åˆ†ä»“ä¸Šæ¨¡å‹ä¸æ”¯æŒï¼Œå®éªŒæ€§æ¥å£ï¼Œè°¨æ…ä½¿ç”¨ã€‚å¯ä»¥å‚è€ƒmindformers.modules.transformer.moe.MoEConfig
    - expert_num: ä¸“å®¶æ•°é‡
    - capacity_factor: ä¸“å®¶èƒ½åŠ›å› å­
    - aux_loss_factor: lossè´¡çŒ®å› å­
    - num_experts_chosen: æ¯ä¸ªtokené€‰æ‹©ä¸“å®¶æ•°ç›®
    - balance_via_topk_bias: ä½¿èƒ½aux_loss_freeè´Ÿè½½å‡è¡¡ç®—æ³•
    - topk_bias_update_rateï¼šaux_loss_freeè´Ÿè½½å‡è¡¡ç®—æ³•biasæ›´æ–°æ­¥é•¿
    - comp_comm_parallel: æ˜¯å¦å¼€å¯ffnçš„è®¡ç®—é€šä¿¡å¹¶è¡Œã€‚é»˜è®¤å€¼ï¼šFalseã€‚
    - comp_comm_parallel_degree: ffnè®¡ç®—é€šä¿¡çš„åˆ†å‰²æ•°ã€‚æ•°å­—è¶Šå¤§ï¼Œé‡å è¶Šå¤šï¼Œä½†ä¼šæ¶ˆè€—æ›´å¤šå†…å­˜ã€‚æ­¤å‚æ•°ä»…åœ¨comp_com_parallelå¯ç”¨æ—¶æœ‰æ•ˆã€‚
    - use_gating_sigmoid: MoEä¸­gatingçš„ç»“æœä½¿ç”¨sigmoidå‡½æ•°
    - use_gmm: MoEä¸“å®¶è®¡ç®—æ˜¯å¦ä½¿ç”¨GroupedMatmulã€‚
    - use_fused_ops_permute: æ˜¯å¦ä½¿ç”¨permuteï¼Œunpermuteèåˆç®—å­è¿›è¡Œæ€§èƒ½åŠ é€Ÿï¼Œä»…åœ¨use_gmm=Trueæ—¶ç”Ÿæ•ˆã€‚
    - enable_deredundency: æ˜¯å¦å¼€å¯å»å†—ä½™é€šä¿¡ï¼Œè¦æ±‚ä¸“å®¶å¹¶è¡Œæ•°æ˜¯æ¯ä¸ªèŠ‚ç‚¹ä¸­npuå¡æ•°é‡çš„æ•´æ•°å€ï¼Œå½“use_gmmä¸ºTrueæ—¶ç”Ÿæ•ˆã€‚
    - npu_nums_per_device: æ¯ä¸ªèŠ‚ç‚¹ä¸­npuå¡çš„æ•°é‡ï¼Œå½“enable_deredundency=Trueæ—¶ç”Ÿæ•ˆã€‚
    - enable_gmm_safe_tokens: ä¿è¯æ¯ä¸ªä¸“å®¶è‡³å°‘åˆ†é…1ä¸ªtokensï¼Œé¿å…æåº¦è´Ÿè½½ä¸å‡è¡¡æƒ…å†µä¸‹ï¼ŒGroupedMatmulè®¡ç®—å¤±è´¥ã€‚å½“use_gmm=Trueæ—¶ï¼Œå»ºè®®å¼€å¯ã€‚
- recompute_configï¼šé‡è®¡ç®—é…ç½®ï¼Œå¯ä»¥å‚è€ƒmindformers.modules.transformer.TransformerRecomputeConfig
    - recompute: æ˜¯å¦å¼€å¯é‡è®¡ç®—
    - select_recompute: æ˜¯å¦å¼€å¯é€‰æ‹©é‡è®¡ç®—ï¼Œåªé’ˆå¯¹attentionå±‚çš„ç®—å­è¿›è¡Œé‡è®¡ç®—
    - parallel_optimizer_comm_recompute: ç”±ä¼˜åŒ–å™¨å¹¶è¡Œå¼•å…¥çš„AllGatheré€šä¿¡æ˜¯å¦é‡è®¡ç®—
    - mp_comm_recompute: ç”±æ¨¡å‹å¹¶è¡Œå¼•å…¥çš„é€šä¿¡æ“ä½œæ˜¯å¦é‡è®¡ç®—
    - recompute_slice_activation: æ˜¯å¦æŠŠä¿ç•™åœ¨å†…å­˜ä¸­çš„Cellè¾“å‡ºåˆ‡ç‰‡
- auto_tune: æ˜¯å¦å¼€å¯è‡ªåŠ¨æ•°æ®åŠ é€Ÿï¼Œå¯ä»¥å‚è€ƒ[mindspore.dataset.config.set_enable_autotune](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/dataset/mindspore.dataset.config.set_enable_autotune.html)
- filepath_prefix: ä¼˜åŒ–åçš„å…¨å±€é…ç½®çš„ä¿å­˜è·¯å¾„+æ–‡ä»¶å‰ç¼€
- autotune_per_step: è®¾ç½®è‡ªåŠ¨æ•°æ®åŠ é€Ÿçš„é…ç½®è°ƒæ•´stepé—´éš”ï¼Œå¯ä»¥å‚è€ƒ[mindspore.dataset.config.set_autotune_interval](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/dataset/mindspore.dataset.config.set_autotune_interval.html)
- profile: æ˜¯å¦å¼€å¯æ€§èƒ½åˆ†æå·¥å…·ï¼Œå¯ä»¥å‚è€ƒ[mindspore.Profiler](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/mindspore/mindspore.Profiler.html)
- profile_start_step: æ€§èƒ½åˆ†æå¼€å§‹çš„step
- profile_stop_step: æ€§èƒ½åˆ†æç»“æŸçš„step
- profile_communication: æ˜¯å¦åœ¨å¤šè®¾å¤‡è®­ç»ƒä¸­æ”¶é›†é€šä¿¡æ€§èƒ½æ•°æ®
- profile_memory: æ˜¯å¦æ”¶é›†Tensorå†…å­˜æ•°æ®
- init_start_profile: æ˜¯å¦åœ¨Profileråˆå§‹åŒ–çš„æ—¶å€™å¼€å¯æ•°æ®é‡‡é›†ã€‚å¼€å¯åprofile_start_stepå°†ä¸ç”Ÿæ•ˆã€‚å¦‚æœéœ€è¦æ”¶é›†å¤šè®¾å¤‡é€šä¿¡æ•°æ®åˆ™å¿…é¡»å¼€å¯ã€‚
- trainer: è®­ç»ƒæµç¨‹é…ç½®
    - type: è®­ç»ƒæµç¨‹ç±»
    - model_name: è®­ç»ƒæ¨¡å‹å
- do_eval: æ˜¯å¦å¼€å¯è¾¹è®­ç»ƒè¾¹è¯„ä¼°
- eval_step_interval: è¯„ä¼°stepé—´éš”, é»˜è®¤ä¸º100ï¼Œè¡¨ç¤ºæ¯100ä¸ªstepé—´éš”æ‰§è¡Œä¸€æ¬¡è¯„ä¼°ï¼›é…ç½®ä¸ºå¤§äº0çš„æ•°è¡¨ç¤ºæ¯éš”æ‰€é…ç½®çš„stepæ•°åæ‰§è¡Œä¸€æ¬¡è¯„ä¼°ï¼Œé…ç½®ä¸ºå°äº0çš„æ•°åˆ™è¡¨ç¤ºç¦ç”¨stepè¯„ä¼°
- eval_epoch_interval: è¯„ä¼°epoché—´éš”, é»˜è®¤ä¸º-1ï¼Œè¡¨ç¤ºç¦ç”¨epochç»“æŸæ—¶çš„è¯„ä¼°ï¼›é…ç½®ä¸ºå¤§äº0çš„æ•°è¡¨ç¤ºæ¯éš”æ‰€é…ç½®çš„epochæ•°åæ‰§è¡Œä¸€æ¬¡è¯„ä¼°ï¼Œé…ç½®ä¸ºå°äº0çš„æ•°åˆ™è¡¨ç¤ºç¦ç”¨epochè¯„ä¼°ï¼›æ³¨æ„ï¼šæ•°æ®ä¸‹æ²‰æ¨¡å¼ä¸‹ï¼Œepochæ‰€åŒ…å«çš„stepæ•°å°†ä»æ•°æ®é›†å¤§å°å˜ä¸ºsink sizeçš„å¤§å°ï¼Œä¸å»ºè®®åœ¨æ•°æ®ä¸‹æ²‰æ¨¡å¼ä¸‹ä½¿ç”¨æœ¬é¡¹é…ç½®
- train_dataset: è®­ç»ƒæ•°æ®é›†é…ç½®ï¼Œå¯ä»¥å‚è€ƒ[mindspore.dataset.GeneratorDataset](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/dataset/mindspore.dataset.GeneratorDataset.html)
    - seed: éšæœºç§å­
    - batch_size: æ‰¹æ¬¡å¤§å°ï¼Œå½“å‰åœ¨ä½¿ç”¨yamlåˆå§‹åŒ–è®­ç»ƒæ—¶ï¼Œè¯¥å‚æ•°ä¼šè¢«runner_configä¸­çš„batch_sizeè¦†ç›–
    - data_loader: æ•°æ®åŠ è½½é…ç½®ï¼Œå¯ä»¥å‚è€ƒ[mindspore.dataset.ImageFolderDataset](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/dataset/mindspore.dataset.ImageFolderDataset.html)
        - type: æ•°æ®åŠ è½½ç±»
        - dataset_dir: æ•°æ®é›†çš„æ ¹ç›®å½•æˆ–æ•°æ®é›†æ–‡ä»¶çš„è·¯å¾„
        - num_parallel_workers: è¯»å–æ•°æ®çš„å·¥ä½œçº¿ç¨‹æ•°
        - shuffle: æ˜¯å¦æ··æ´—æ•°æ®é›†
    - transforms: æ•°æ®å¢å¼ºæ“ä½œ
    - tokenizer: è®­ç»ƒæ•°æ®é¢„å¤„ç†ä½¿ç”¨çš„åˆ†è¯å™¨
        - type: åˆ†è¯å™¨ç±»
        - vocab_file: è¯è¡¨æ–‡ä»¶è·¯å¾„
        - max_length: åˆ†è¯å™¨è¾“å‡ºçš„æœ€å¤§é•¿åº¦
    - mixup_op:  å›¾åƒéšæœºæ··åˆï¼Œå¯ä»¥å‚è€ƒ[mindspore.dataset.vision.MixUp](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/dataset_vision/mindspore.dataset.vision.MixUp.html)
    - input_columns: è¾“å…¥æ•°æ®åˆ—
    - output_columns: è¾“å‡ºæ•°æ®åˆ—
    - column_order: è¾“å‡ºæ•°æ®é¡ºåº
    - num_parallel_workers: è¯»å–æ•°æ®çš„å·¥ä½œè¿›ç¨‹æ•°/çº¿ç¨‹æ•°
    - python_multiprocessing: å¯ç”¨Pythonå¤šè¿›ç¨‹æ¨¡å¼åŠ é€Ÿè¿ç®—
    - drop_remainder: å½“æœ€åä¸€ä¸ªæ‰¹å¤„ç†æ•°æ®åŒ…å«çš„æ•°æ®æ¡ç›®å°äºbatch_sizeæ—¶ï¼Œæ˜¯å¦å°†è¯¥æ‰¹å¤„ç†ä¸¢å¼ƒ
    - repeat: é‡å¤æ­¤æ•°æ®é›†countæ¬¡
    - numa_enable: è®¾ç½®NUMAçš„é»˜è®¤çŠ¶æ€ä¸ºå¯åŠ¨çŠ¶æ€
    - prefetch_size: è®¾ç½®ç®¡é“ä¸­çº¿ç¨‹çš„é˜Ÿåˆ—å®¹é‡
- eval_dataset: è¯„ä¼°æ•°æ®é›†é…ç½®ï¼Œå…·ä½“é…ç½®è¯´æ˜å¯å‚è€ƒtrain_dataset
- model: æ¨¡å‹é…ç½®
    - arch: æ¨¡å‹ç±»é…ç½®
        - type: æ¨¡å‹ç±»
    - model_config: æ¨¡å‹å‚æ•°é…ç½®
        - type: æ¨¡å‹å‚æ•°é…ç½®ç±»
        - checkpoint_name_or_path: è¯„ä¼°æ—¶ä¸æŒ‡å®šæƒé‡ï¼Œæ¨¡å‹é»˜è®¤åŠ è½½çš„æƒé‡å

          *\# ä»¥ä¸‹é…ç½®é’ˆå¯¹å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹æ¨ç†*
        - top_k: ä»æ¦‚ç‡æœ€å¤§çš„top_kä¸ªtokensä¸­é‡‡æ ·
        - top_p: ä»æ¦‚ç‡æœ€å¤§ä¸”æ¦‚ç‡ç´¯è®¡ä¸è¶…è¿‡top_pçš„tokensä¸­é‡‡æ ·
        - do_sample: ä½¿èƒ½top_kæˆ–top_pé‡‡æ ·ï¼Œä¸ºFalseæ—¶top_kå’Œtop_på‡é‡ç½®ä¸º1
        - use_past: ä½¿èƒ½å¢é‡æ¨ç†ï¼Œä¸ºTrueæ—¶ä¸ºå¢é‡æ¨ç†ï¼Œå¦åˆ™ä¸ºè‡ªå›å½’æ¨ç†ï¼Œå½“å‰å¼€å¯åä¼šä½¿ç”¨Paged Attentionè¿›è¡Œè®¡ç®—ï¼Œä½¿ç”¨æ—¶è¯·å‚è€ƒ[æ¨¡å‹æ”¯æŒåˆ—è¡¨](https://gitee.com/mindspore/mindformers/tree/r1.5.0/docs#text-generator)
        - max_decode_length: æ–‡æœ¬ç”Ÿæˆæœ€å¤§é•¿åº¦ï¼ˆè¾“å…¥é•¿åº¦ç»Ÿè®¡åœ¨å†…ï¼‰
        - max_length: æ–‡æœ¬ç”Ÿæˆæœ€å¤§é•¿åº¦ï¼ˆè¾“å…¥é•¿åº¦ç»Ÿè®¡åœ¨å†…ï¼‰ï¼Œæ•ˆæœç­‰åŒäºmax_decode_lengthï¼ŒåŒæ—¶å­˜åœ¨æ—¶ä»¥max_lengthä¸ºå‡†
        - max_new_tokens: æ–‡æœ¬æ–°ç”Ÿæˆçš„æœ€å¤§é•¿åº¦ï¼ˆè¾“å…¥é•¿åº¦ä¸ç»Ÿè®¡åœ¨å†…ï¼‰ï¼Œä¸max_lengthåŒæ—¶è®¾ç½®æ—¶ï¼Œä»¥max_new_tokensä¸ºå‡†
        - min_length: æ–‡æœ¬ç”Ÿæˆæœ€å°é•¿åº¦ï¼ˆè¾“å…¥é•¿åº¦ç»Ÿè®¡åœ¨å†…ï¼‰
        - min_new_tokens: æ–‡æœ¬æ–°ç”Ÿæˆæœ€å°é•¿åº¦ï¼ˆè¾“å…¥é•¿åº¦ä¸ç»Ÿè®¡åœ¨å†…ï¼‰ï¼Œä¸min_lengthåŒæ—¶è®¾ç½®æ—¶ï¼Œä»¥min_new_tokensä¸ºå‡†
        - repetition_penalty: é‡å¤æ–‡æœ¬æƒ©ç½šç³»æ•°ï¼Œè¯¥å€¼ä¸å°äº1ï¼Œç­‰äº1æ—¶ä¸æƒ©ç½š
        - block_size: ä½¿ç”¨Paged Attentionæ¨ç†æ—¶éœ€è®¾ç½®ï¼Œæ¯å—blockçš„å¤§å°
        - num_blocks: ä½¿ç”¨Paged Attentionæ¨ç†æ—¶éœ€è®¾ç½®ï¼Œblocksçš„æ€»æ•°ã€‚å½“å‰é…ç½®éœ€è¦ä¿è¯batch_size*seq_length<=block_size*num_blocksï¼Œå¦åˆ™è¿è¡Œè¿‡ç¨‹ä¸­ä¼šæç¤ºPAçš„å†…å­˜æ± ä¸è¶³
        - return_dict_in_generate: ä»¥å­—å…¸å½¢å¼è¿”å›generateè¾“å‡ºç»“æœï¼Œé»˜è®¤ä¸ºFalse
        - output_scores: å­—å…¸è¿”å›è¾“å‡ºæ—¶ï¼Œæ˜¯å¦åŒ…å«æ¯æ¬¡å‰å‘ç”Ÿæˆæ—¶çš„è¿›å…¥softmaxå‰çš„åˆ†æ•°ç»“æœï¼Œé»˜è®¤ä¸ºFalse
        - output_logits: å­—å…¸è¿”å›è¾“å‡ºæ—¶ï¼Œæ˜¯å¦åŒ…å«æ¯æ¬¡å‰å‘ç”Ÿæˆæ—¶æ¨¡å‹è¾“å‡ºçš„logitsï¼Œé»˜è®¤ä¸ºFalse
        - fused_rms_norm: æ¨¡å‹å¾®è°ƒæ—¶ï¼Œæ˜¯å¦ä½¿ç”¨èåˆç®—å­ï¼Œé»˜è®¤ä¸ºTrue
- lr_schedule: å­¦ä¹ ç‡é…ç½®
    - type: å­¦ä¹ ç‡ç±»
- layer_scale: æ˜¯å¦å¼€å¯å±‚è¡°å‡
- layer_decay: å±‚è¡°å‡ç³»æ•°
- optimizer: ä¼˜åŒ–å™¨é…ç½®
    - type: ä¼˜åŒ–å™¨ç±»
    - weight_decay: æƒé‡è¡°å‡å€¼
- lr_scale: æ˜¯å¦å¼€å¯å­¦ä¹ ç‡ç¼©æ”¾
- lr_scale_factor: å­¦ä¹ ç‡ç¼©æ”¾ç³»æ•°
- callbacks: å›è°ƒå‡½æ•°é…ç½®
    - type: å›è°ƒå‡½æ•°ç±»
    - type: MFLossMonitor: lossæ‰“å°
    - type: SummaryMonitor: æ”¶é›†summaryæ•°æ®ï¼Œå¯ä»¥å‚è€ƒ[mindspore.SummaryCollector](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/mindspore/mindspore.SummaryCollector.html)
    - type: CheckpointMonitor: checkpointä¿å­˜ï¼Œå¯ä»¥å‚è€ƒ[mindspore.save_checkpoint](https://www.mindspore.cn/docs/zh-CN/r2.3.0/api_python/mindspore/mindspore.save_checkpoint.html)
        - prefix: æƒé‡æ–‡ä»¶å‰ç¼€
        - directory: ä¿å­˜æƒé‡çš„ç›®å½•
        - save_checkpoint_seconds: è®¾å®šå¤šå°‘sä¿å­˜ä¸€æ¬¡ckpt
        - save_checkpoint_steps: æ¯å¤šå°‘ä¸ªstepä¿å­˜ä¸€æ¬¡checkpoint
        - keep_checkpoint_max: è®¾å®šä¿å­˜ckptçš„æœ€å¤§æ•°é‡ï¼Œè¶…è¿‡åˆ™ä¼šåˆ é™¤æœ€æ—§çš„æƒé‡ï¼Œä»¥ä¿è¯æ•°é‡ä¸å˜
        - keep_checkpoint_per_n_minutes: è®¾å®šå¤šå°‘minutesä¿å­˜ä¸€æ¬¡ckpt
        - integrated_save: æ˜¯å¦èšåˆä¿å­˜ã€‚Trueæ—¶è¡¨ç¤ºèšåˆæ‰€æœ‰å¡æƒé‡ï¼Œè¿™æ—¶æ¯å¼ å¡æƒé‡å‡ä¸€è‡´ï¼›Falseæ—¶è¡¨ç¤ºæ¯å¼ å¡å„è‡ªä¿å­˜è‡ªå·±çš„æƒé‡ï¼›å½“åŠè‡ªåŠ¨å¹¶è¡Œæ¨¡å¼è®­ç»ƒå¤§æ¨¡å‹æ—¶ï¼Œé€šå¸¸éœ€è¦è®¾ç½®ä¸ºFalseï¼Œä»¥ä¿è¯æƒé‡ä¿å­˜æ—¶ä¸ä¼šå› ä¸ºå†…å­˜é—®é¢˜è€Œå¤±è´¥
        - save_network_paramsï¼ˆæ–°å¢ï¼‰: æ˜¯å¦é¢å¤–ä¿å­˜ç˜¦èº«åçš„æƒé‡ã€‚é»˜è®¤ä¸ºTrueã€‚
        - save_trainable_paramsï¼ˆæ–°å¢ï¼‰: æ˜¯å¦é¢å¤–ä¿å­˜å¯è®­ç»ƒçš„å‚æ•°æƒé‡ï¼Œå³å¾®è°ƒéƒ¨åˆ†å‚æ•°çš„æƒé‡ã€‚é»˜è®¤ä¸ºFalseã€‚
        - async_save: æ˜¯å¦å¼‚æ­¥æ‰§è¡Œä¿å­˜checkpointæ–‡ä»¶
    - type: ObsMonitor: obsæ•°æ®ä¸Šä¼ 
        - step_upload_frequence: æ¯éš”å¤šå°‘ä¸ªstepä¸Šä¼ ä¸€æ¬¡ï¼Œé»˜è®¤ä¸º100ï¼Œè¡¨ç¤ºæ¯100ä¸ªstepæ‰§è¡Œä¸€æ¬¡æ•°æ®ä¸Šä¼ ï¼›é…ç½®ä¸ºå¤§äº0çš„æ•°æ—¶ï¼Œæ¯éš”é…ç½®æ•°stepåæ‰§è¡Œä¸€æ¬¡å›ä¼ ï¼Œå°äº0çš„æ•°åˆ™è¡¨ç¤ºç¦ç”¨stepå›ä¼ 
        - epoch_upload_frequence: æ¯éš”å¤šå°‘ä¸ªepochä¸Šä¼ ä¸€æ¬¡ï¼Œé»˜è®¤ä¸º-1ï¼Œè¡¨ç¤ºç¦ç”¨epochå›ä¼ ï¼›è®¾ç½®å¤§äº0çš„å€¼è¡¨ç¤ºæ¯éš”æ‰€é…ç½®çš„epochæ•°åå›ä¼ ï¼›æ³¨æ„ï¼šæ•°æ®ä¸‹æ²‰æ¨¡å¼ä¸‹ï¼Œepochæ‰€åŒ…å«çš„stepæ•°å°†ä»æ•°æ®é›†å¤§å°å˜ä¸ºsink sizeçš„å¤§å°ï¼Œä¸å»ºè®®åœ¨æ•°æ®ä¸‹æ²‰æ¨¡å¼ä¸‹ä½¿ç”¨æœ¬é¡¹é…ç½®
        - keep_last: æ£€æŸ¥obsçš„æ–‡ä»¶ä¸AIè®¡ç®—ä¸­å¿ƒå¹³å°æ˜¯å¦ä¸€è‡´ï¼Œé»˜è®¤Trueï¼Œè¡¨ç¤ºä»…ä¿ç•™æœ€åä¸€æ¬¡å›ä¼ çš„å†…å®¹ï¼Œå‰é¢å‡ æ¬¡å›ä¼ å†…å®¹å°†ä¼šè¢«ç§»é™¤ï¼›è®¾ä¸ºFalseåˆ™ä¼šä¿ç•™æ¯æ¬¡å›ä¼ çš„å†…å®¹
    - type: OnRequestExit: å¼€å¯ä¼˜é›…é€€å‡ºåŠŸèƒ½éœ€è¦è®¾ç½®,å¯ä»¥å‚è€ƒ[mindspore.train.OnRequestExit](https://www.mindspore.cn/docs/zh-CN/r2.4.0/api_python/train/mindspore.train.OnRequestExit.html)
- metric: è¯„ä¼°æŒ‡æ ‡é…ç½®
    - type: è¯„ä¼°æŒ‡æ ‡ç±»
- processor: æ¨ç†æ—¶çš„æ•°æ®å¤„ç†
    - return_tensors: è¿”å›å¼ é‡ç±»å‹
    - type: æ•°æ®å¤„ç†ç±»
    - image_processor: å›¾åƒå¤„ç†é…ç½®
        - type: å›¾åƒå¤„ç†ç±»
    - tokenizer: æ–‡æœ¬ç”Ÿæˆæ‰€ä½¿ç”¨çš„åˆ†è¯å™¨é…ç½®
        - type: åˆ†è¯å™¨ç±»
        - vocab_fileï¼šè¯è¡¨æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¼šè‡ªåŠ¨ä¸‹è½½è‡³é»˜è®¤è·¯å¾„ä¸‹ã€‚
